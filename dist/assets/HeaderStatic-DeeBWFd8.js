import{G as v,d as w,a as k,u as h,r as c,j as e,b as C,p as z,q as A,t as B,v as M,w as U,B as $,x as D,L as u,y as I,z as H,A as P,D as T,E as q}from"./index-rrPmFSZK.js";function G(r){return v({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M376.6 84.5c11.3-13.6 9.5-33.8-4.1-45.1s-33.8-9.5-45.1 4.1L192 206 56.6 43.5C45.3 29.9 25.1 28.1 11.5 39.4S-3.9 70.9 7.4 84.5L150.3 256 7.4 427.5c-11.3 13.6-9.5 33.8 4.1 45.1s33.8 9.5 45.1-4.1L192 306 327.4 468.5c11.3 13.6 31.5 15.4 45.1 4.1s15.4-31.5 4.1-45.1L233.7 256 376.6 84.5z"},child:[]}]})(r)}function X(r){return v({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"},child:[]},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"},child:[]}]})(r)}const _=({isOpen:r,setIsOpen:m})=>{const x=w(),d=k(),t=h(s=>{var l;return(l=s==null?void 0:s.notifications)==null?void 0:l.unseenNotiCount}),a=h(s=>{var l;return(l=s==null?void 0:s.notifications)==null?void 0:l.notifications}),o=async()=>{try{await C.post("/notification/seen"),d(z())}catch(s){console.error("Error marking notifications as seen:",s)}};c.useEffect(()=>{r&&t&&o()},[r,o]);const f=s=>new Date(s).toLocaleString("en-US",{day:"numeric",month:"short",hour:"2-digit",minute:"2-digit"});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:`fixed top-0 right-0 h-full w-80 bg-white shadow-lg transform transition-transform duration-300 z-40 ${r?"translate-x-0":"translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-[#004969] text-white",children:[e.jsx("h2",{className:"text-lg font-semibold",children:"Notifications"}),e.jsx("button",{onClick:()=>m(!1),className:"p-2 rounded-full hover:bg-blue-600",children:e.jsx(X,{size:24})})]}),e.jsx("div",{className:"p-4 overflow-y-auto h-full",children:a.length>0?a.map(s=>{var l,p,g;return e.jsxs("div",{className:`flex cursor-pointer items-center gap-4 p-3 mb-3 rounded-md shadow-sm ${s.seen?"bg-gray-100":"bg-blue-100"}`,children:[e.jsx("img",{onClick:()=>x("/seller/"+s.user._id),src:(l=s==null?void 0:s.user)==null?void 0:l.profilePicture,alt:((p=s==null?void 0:s.user)==null?void 0:p.fullName)||"User",className:"w-10 h-10 rounded-full object-cover"}),e.jsxs("div",{onClick:()=>x("/reels/"+(s==null?void 0:s.referenceId)),children:[e.jsx("p",{className:"font-medium text-gray-800",children:((g=s==null?void 0:s.user)==null?void 0:g.fullName)||"Unknown User"}),e.jsx("p",{className:"text-sm text-gray-500",children:s.content}),e.jsx("p",{className:"text-xs text-gray-400",children:f(s.createdAt)})]})]},s._id)}):e.jsx("p",{className:"text-gray-500",children:"No notifications yet."})})]}),r&&e.jsx("div",{onClick:()=>m(!1),className:"fixed inset-0 bg-black opacity-50 z-30"})]})},O=()=>{const r=k(),m=h(t=>{var a;return(a=t.notifications)==null?void 0:a.notifications}),x=h(t=>{var a;return(a=t==null?void 0:t.notifications)==null?void 0:a.unseenNotiCount}),d=h(t=>t.socket.value);return c.useEffect(()=>{(async()=>{try{const a=await C.get("/notification/get");r(A(a.data.notifications))}catch(a){console.error("Error fetching notifications:",a)}})()},[r]),c.useEffect(()=>{if(!d)return;const t=a=>{r(B(a))};return d.on("newNotifications",t),()=>{d.off("newNotifications",t)}},[d,r]),{notifications:m,unseenCount:x}},R=()=>{const r="https://admin.reeldekho.com",m="https://socket.reeldekho.com",[x,d]=c.useState(!1),[t,a]=c.useState([]),[o,f]=c.useState([]),s=h(n=>{var i;return(i=n==null?void 0:n.auth)==null?void 0:i.user}),l=w(),[p,g]=c.useState(!1),{unseenCount:b}=O(),j=()=>{d(!x)},S=async()=>{const n=await q.get(`${r}/post/fetchheader`);a(n.data.value),f(n.data.settin)};c.useEffect(()=>{(!t||!t.length)&&S()},[t]);const L=async()=>{localStorage.clear(),window.location.reload()},N=h(n=>{var i;return(i=n==null?void 0:n.chat)==null?void 0:i.unSeenCount}),[y,F]=c.useState(0);return c.useEffect(()=>{console.log(N);const n=Object.values(N).reduce((i,E)=>i+E,0);console.log(n),F(n)},[N]),e.jsxs("header",{className:"relative top-0 left-0 w-full z-50 bg-white dark:bg-black shadow-md fixedtio",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-2 md:px-8",children:[e.jsx("div",{children:e.jsx("button",{onClick:j,className:"text-gray-800 focus:outline-none",children:e.jsx(M,{className:"text-2xl dark:text-white "})})}),e.jsx("div",{className:"text-center",children:e.jsx("img",{src:`${m}/public/Images/${o.rectangleLogo}`,alt:"Logo",className:"h-8 object-contain mx-auto bg-blend-color-burn bg-black"})}),e.jsxs("div",{className:" flex gap-2 items-center",children:[e.jsxs("div",{onClick:()=>g(!0),className:" relative flex items-center h-full ",children:[e.jsx("button",{className:"text-gray-800 focus:outline-none",children:e.jsx(U,{className:"text-2xl dark:text-white "})}),b?e.jsxs("p",{className:" absolute top-[-13px] left-[-6px] font-bold text-md flex items-center justify-center p-2 text-white bg-red-500 h-5 w-5 rounded-full ",children:[" ",b," "]}):null]}),e.jsxs("div",{className:" relative flex items-center h-full  ",children:[e.jsx($,{onClick:()=>l("/messages"),className:"w-6 h-6 text-gray-500 cursor-pointer"}),y?e.jsxs("p",{className:" absolute top-[-13px] left-[-6px] font-bold text-md flex items-center justify-center p-2 text-white bg-red-500 h-5 w-5 rounded-full ",children:[" ",y," "]}):null]})]})]}),e.jsxs("div",{className:`fixed top-0 left-0 h-full w-64 bg-white shadow-lg z-40 transform transition-transform duration-300 ${x?"translate-x-0":"-translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-4 border-b",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Menu"}),e.jsx("button",{onClick:j,className:"text-gray-800 focus:outline-none",children:e.jsx(D,{className:"text-2xl"})})]}),e.jsxs("ul",{className:"flex flex-col mt-4",children:[e.jsx("li",{className:"py-3 px-4 hover:bg-gray-100 cursor-pointer",children:"Home"}),s?e.jsxs(e.Fragment,{children:[e.jsx("li",{className:"py-3 px-4 hover:bg-gray-100 cursor-pointer",children:"Change Password"}),e.jsx("li",{onClick:L,className:"py-3 px-4 hover:bg-gray-100 cursor-pointer",children:"Logout"}),e.jsx(u,{to:"/saved",children:e.jsx("li",{className:"py-3 px-4 hover:bg-gray-100 cursor-pointer",children:"Saved"})}),e.jsx("li",{className:"py-3 px-4 hover:bg-gray-100 cursor-pointer",children:"Delete Account"})]}):e.jsxs(e.Fragment,{children:[e.jsx("li",{className:"py-3 px-4 hover:bg-gray-100 cursor-pointer",onClick:()=>l("/login"),children:" Login "}),e.jsx("li",{className:"py-3 px-4 hover:bg-gray-100 cursor-pointer",onClick:()=>l("/signup"),children:" Sign-up "})]}),e.jsx(u,{to:"/faq",children:e.jsx("li",{className:"py-3 px-4 hover:bg-gray-100 cursor-pointer",children:"FAQ"})}),t.map((n,i)=>e.jsx(u,{to:`/page/${n.Title}`,children:e.jsx("li",{className:"py-3 px-4 hover:bg-gray-100 cursor-pointer",children:n.Title},i)}))]}),e.jsx("div",{className:"relative h-screen",children:e.jsxs("ul",{className:"absolute flex justify-center w-full space-x-4 p-4 bg-white",style:{marginBottom:"1px"},children:[e.jsx(u,{to:o.facebook,children:e.jsx("li",{children:e.jsx(I,{className:"text-xl text-blue-600 cursor-pointer"})})}),e.jsx(u,{to:o.instagram,children:e.jsx("li",{children:e.jsx(H,{className:"text-xl text-red-600 cursor-pointer"})})}),e.jsx(u,{to:o.twitter,children:e.jsx("li",{children:e.jsx(G,{className:"text-xl text-black-600 cursor-pointer"})})}),e.jsx(u,{to:o.youtube,children:e.jsx("li",{children:e.jsx(P,{className:"text-xl text-red-600 cursor-pointer"})})}),e.jsx(u,{to:o.playstore,children:e.jsx("li",{children:e.jsx(T,{className:"text-xl text-gray-800 cursor-pointer"})})})]})})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30",onClick:j}),e.jsx(_,{setIsOpen:g,isOpen:p})]})};export{R as H};
